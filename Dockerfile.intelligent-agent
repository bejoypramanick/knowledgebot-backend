# Dockerfile.intelligent-agent
# Intelligent Agent Microservice
# Central orchestrator with OpenAI Agents framework

FROM public.ecr.aws/lambda/python:3.12

# Set environment variables for optimization
ENV PIP_DISABLE_PIP_VERSION_CHECK=1
ENV PIP_NO_CACHE_DIR=1
ENV PYTHONUNBUFFERED=1

# Install system dependencies
RUN dnf update -y && \
    dnf install -y \
    gcc \
    gcc-c++ \
    make \
    && dnf clean all

# Copy requirements and install Python dependencies
COPY requirements-intelligent-agent.txt ${LAMBDA_TASK_ROOT}/
RUN pip install --no-cache-dir -r requirements-intelligent-agent.txt

# Copy application code
COPY microservices/intelligent-agent-handler.py ${LAMBDA_TASK_ROOT}/lambda_function.py

# Create necessary directories
RUN mkdir -p /tmp/agent

# Set proper permissions
RUN chmod 755 ${LAMBDA_TASK_ROOT}/lambda_function.py

CMD ["lambda_function.lambda_handler"]
